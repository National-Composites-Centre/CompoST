Architecture
============

.. image:: NCC-TEC-4376.*
    :width: 1000
	
On the figure above, arrows point from an object 1 to object 2, where object 1 inherits from object 2.

The figure is also work-in-progress. The outline titled "mostly fixed" houses the objects that have been implemented and used. These will hopefully see only minor adjustments. Objects outside this area might end up being standardised differently than currently suggested.

All fields are optional unless otherwise specified, or unless required to construct specific object.

Where the same attribute is being called in parent and child (e.g. axis being referenced in ply, and in some of corresponding cut pieces), the more detailed (child) component supersedes the corresponding parent definition.


CompositeDB object is the main object of the Composite Standard. All objects are stored in lists named all***.  
	
	
.. py:function:: CompositeStandard.CompositeDB(BaseModel)

	All elements and all geometry are all stored here and used elsewhere as refrence
	Points are stored withing those, as referencing is not efficient
	
	BaseModel input signifies the default generation with Pydantic library, without any local parent.
	
	:param name: str - name
	:param rootElements: list - List of CompositeElement type objects
	:param allEvents: list  - List of "events" objects - all = exhaustive list
	:param allGeometry: list - list of "GeometricElement" objects - all = exhaustive list
	:param allStages: list - manuf process - all = exhaustive list
	:param allMaterials: list - List of "Material" objects - all = exhaustive list
	:param fileMetadata: object - list of all "axisSystems" objects = exhaustive list
	
.. py:function:: CompositeStandard.FileMetadata(BaseModel)
	
	Metadata related to this particular part.
	
	:param lastModified: date 
	:param lastModifiedBy: str - latest changes to the file have been done by
	:param author: str - initial part definition created by
	:param version: str - version of the CompoST used to work with this file
	:param layupDefinitionVersion: str - initial part layup definition generated by 
	:param cadFile: str - related CAD file, if references to geometries are required, .step format is recommended. Should be stored in same folder.
	:param maxID: int - maxium ID used for any object int the file, used for preventing duplicaiton of IDs
	:param cadFilepath: str - should only be used when CAD could not be stored in same folder as this file
	
	
.. py:function:: CompositeStandard.CompositeDBItem(BaseModel)

	:param memberName: str - name
	:param additionalParameters: dict - to hold use-case specific values (to be further defined)
	:param additionalProperties: dict - to hold use-case specific objects (to be further defined)
	:param stageIDs: (TODO) - stages will define what part of part-processing this object came from
	:param batchIDs: (TODO) - reference to batch of components 
	:param ID: int - used for references between objects


.. py:function:: CompositeStandard.GeometricElement(CompositeDBItem)
	
	:param source: str - the software, script, or database that this object originated from
	
.. py:function:: CompositeStandard.CompositeElement(CompositeDBItem)

	This includes any object that is used to describe composite component specifically.
	
	:param database: object - :py:meth:`~CompositeStandard.CompositeDB.get` 
	:param subComponent: list - :py:meth:`~CompositeStandard.CompositeDBItem.get` , either as object or ID
	:param mappedProperties: dict - other properties not covered by materials class or similar
	:param mappedRequirements: list - list of objects of Requirement type, to be further specified
	:param defects: list - list of "defects" type objects
	:param axisSystemID: int - refernce to object in allAxisSystems specified by ID
	:param referencedBy: list - optional list of objects that currently reference this object
	:param status: str - #TODO
	
.. py:function:: CompositeStandard.Point(GeometricElement)

	:param x: float 
	:param y: float
	:param z: float
	
.. py:function:: CompositeStandard.Line(GeometricElement)

	:param points: list - list of two points , no more - no less
	:param IDs: list - list of two IDs corresponding to points, no more - no less
	
	
.. py:function:: CompositeStandard.AxisSystem(GeometricElement)
	
	The three vectors listed bewow must be perpendicular to each other
	
	:param pt: `CompositeStandard.Point` - location of axis system expressed in global axis system
	:param v1x: float - first vector of axis system, first direction
	:param v1y: float - first vector of axis system, second direction
	:param v1z: float - first vector of axis system, third direction
	:param v2x: float - second vector of axis system, first direction
	:param v2y: float - second vector of axis system, second direction
	:param v2z: float - second vector of axis system, third direction
	:param v3x: float - third vector of axis system, first direction
	:param v3y: float - third vector of axis system, second direction
	:param v3z: float - third vector of axis system, third direction
	
.. py:function:: CompositeStandard.Material(BaseModel)

	To be expanded...
	
	User of the format is responsible for using consistent units. CompoST does not enforce units used.

	:param materialName: str
	:param E1: float - young's modulus in primary direction
	:param E2: float - young's modulus in secondary direction (in-plane)
	:param G23: float - shear modulus
	:param G12: float - interlaminar shear modulus
	:param v12: float - poisson ratio in plane
	:param infoSource: str - reference to source of the information
	:param thickness: float - out of plane thickness
	:param density: float 
	:param permeability_1: float - permeability in primary direction
	:param permeability_2: float - permeability in secondary direction (in-plane)
	:param permeability_3: float - permeability out of plane / through thickness
	:param type: str - (List to be provided)
	
.. py:function:: CompositeStandard.Piece

	In practical terms this is section of ply layed-up in one (particulartly relevant for AFP or similar)

	:param placementRosette: int - reference to main rosette for this piece
	:param splineRelimitationRef: int - reference to spline delimiting the boundary of this piece
	:param material: str - reference materialName (IDs not used here, as material can be located in external database)
	
	
.. py:function:: CompositeStandard.Ply(CompositeElement)

	:param placementRosette: int - reference to main rosette for this ply
	:param splineRelimitationRef: int - reference to spline delimiting the boundary of this ply	
	:param material: str - reference materialName (IDs not used here, as material can be located in external database) 	
	:param orientation: float - direction of lay-up with reference to x-axis of placementRosette
	
.. py:function:: CompositeStandard.Sequence(CompositeElement)

	Can either be defined complely by inherited properties (ply list in subComponents).
	
	Or can be defined by list of orientations and materials, if no additional information is required.
	
	For single-material laminate leave "materials" empty, and fill in "singleMaterial"
	
	The subComponents in sequence must be ordered tool placement (first object is initial ply placed on the tool)

	:param placementRosette: int - reference to main rosette for this sequence
	:param orientations: list - list of floats, orientations listed with reference to placementRosette
	:param materials: list - list of strings, materialName's
	:param singleMaterial: str - used only if 1 material is used through-out the sequence
	:param splineRelimitationRef: int - used when all plies end at the same boundary and the lists above are being used	

.. py:function:: CompositeStandard.CompositeComponent(CompositeElement)

	:param integratedComponents: list - allows for integrating othre complete CompoST databases as sub-components
	
.. py:function:: CompositeStandard.SolidComponent(CompositeElement)

	CAD shapes, for instace useful when using a 3D core/insert
	
	:param cadFile: str - file path to the part, or reference to PLM site
	:param sourceSystem: `SourceSystem`
	
.. py:function: CompositeStandard.SourceSystem(BaseModel)
	
	:param softwareName: str 
	:param version: str - version used to generate objects referencing this
	:param link: str - link to GitHub, docs... where appropriate 
	
.. py:function: CompositeStandard.MeshElement(GeometricElement)

	:param nodes: list - `Point` objects 
	:param normal: list - [x,y,z] in the list
	
.. py:function: CompositeStandard.Spline(GeometricElement)

	:param splineType: int - types of splines based on OCC line types (ref to be provided)
	:param pointRefs: list - list of IDs (only use this variable if 'points' variable unused
	:param points: `Point` - This variable prevents complex ID referencing for points that belong to this spline only
	:param length: float - calculated lenght of spline
	
.. py:function: CompositeStandard.Defect(CompositeDBItem)

	:param map: `CompositeStandard.CompositeDBItem` - any composite or geometric object
	:param location: float - x,y,z location
	:param source: `SourceSystem` 
	:param effMaterial: `CompositeStandard.Material` - adjusted material class saved 
	:param status: --- to be defined ---
	:param axisSystemID: int - reference to `AxisSystem` object
	
.. py:function: CompositeStandard.Wrinkle(Defect)

	:param area: float 
	:param aspectRatio: float - typically size_x/size_y
	:param maxRoC: float - machimum rate of changes
	:param size_x: float
	:param size_y: float

class Wrinkle(Defect):

    area: Optional[float] = Field(None)
    aspectRatio: Optional[float] = Field(None) #typically size_x/size_y
    maxRoC: Optional[float] = Field(None)
    size_x: Optional[float] = Field(None) #primary direction size, according to referenced axisSystemID, or global axis if local not available
    size_y: Optional[float] = Field(None)
	
	
	
	